<div class="max-w-xl mx-auto px-4 py-8 font-sans">
  <div class="bg-[#F8F5EC] border-[3px] border-zinc-900 shadow-[8px_8px_0px_0px_rgba(20,20,23,0.8)] relative">

    <%# Header Section %>
    <div class="p-6 border-b-[3px] border-zinc-900 bg-white relative">
      <div class="absolute inset-0 bg-[linear-gradient(to_right,#80808012_1px,transparent_1px),linear-gradient(to_bottom,#80808012_1px,transparent_1px)] bg-[size:10px_10px]"></div>

      <div class="relative z-10">
        <div class="flex items-center justify-between mb-4">
          <%= link_to account_webhooks_path, class: "text-xs font-bold text-zinc-500 hover:text-zinc-900 uppercase tracking-wide" do %>
            &larr; BACK TO WEBHOOKS
          <% end %>
          <%= link_to edit_account_webhook_path(@webhook), class: "text-xs font-bold text-zinc-500 hover:text-zinc-900 uppercase tracking-wide" do %>
            EDIT
          <% end %>
        </div>
        <h1 class="text-2xl font-black text-zinc-900 uppercase tracking-tighter">
          <%= @webhook.name %>
        </h1>
        <p class="text-xs text-zinc-500 font-mono mt-1 break-all"><%= @webhook.url %></p>
      </div>
    </div>

    <%# Body %>
    <div class="p-6 relative flex flex-col gap-6">
      <div class="absolute inset-0 pointer-events-none bg-[linear-gradient(to_right,#8080800a_1px,transparent_1px),linear-gradient(to_bottom,#8080800a_1px,transparent_1px)] bg-[size:20px_20px]"></div>

      <div class="relative z-10 flex flex-col gap-6">
        <%# Status %>
        <% unless @webhook.active? %>
          <div class="p-4 bg-red-50 border-[2px] border-red-300">
            <p class="text-red-700 font-bold text-sm mb-2">WEBHOOK INACTIVE</p>
            <p class="text-red-600 text-xs mb-3">This webhook has been deactivated due to repeated delivery failures.</p>
            <%= button_to "Reactivate Webhook", account_webhook_activation_path(@webhook), method: :post, class: "px-4 py-2 bg-red-600 text-white border-[2px] border-red-700 hover:bg-red-700 transition-colors font-bold text-xs uppercase" %>
          </div>
        <% end %>

        <%# Signing Secret %>
        <div>
          <h2 class="text-xs font-bold text-zinc-500 uppercase tracking-widest mb-2">SIGNING SECRET</h2>
          <code class="block p-3 bg-zinc-100 border-[2px] border-zinc-300 font-mono text-sm break-all"><%= @webhook.signing_secret %></code>
          <p class="text-xs text-zinc-500 mt-2">
            Each request includes a <code class="bg-zinc-100 px-1">X-Webhook-Signature</code> header.
            Verify it using HMAC SHA256 of the request body with this secret.
          </p>
        </div>

        <div class="w-full h-[2px] bg-zinc-200"></div>

        <%# Subscribed Events %>
        <div>
          <h2 class="text-xs font-bold text-zinc-500 uppercase tracking-widest mb-2">SUBSCRIBED EVENTS</h2>
          <% if @webhook.subscribed_actions.any? %>
            <ul class="flex flex-wrap gap-2">
              <% @webhook.subscribed_actions.each do |action| %>
                <li class="px-3 py-1 bg-zinc-900 text-white text-xs font-bold uppercase">
                  <%= webhook_action_label(action) %>
                </li>
              <% end %>
            </ul>
          <% else %>
            <p class="text-zinc-500 text-sm">No events subscribed. This webhook will never trigger.</p>
          <% end %>
        </div>

        <div class="w-full h-[2px] bg-zinc-200"></div>

        <%# Delivery History %>
        <div>
          <h2 class="text-xs font-bold text-zinc-500 uppercase tracking-widest mb-2">RECENT DELIVERIES</h2>
          <% if @deliveries.any? %>
            <div class="flex flex-col gap-2">
              <% @deliveries.each do |delivery| %>
                <%= render "delivery", delivery: delivery %>
              <% end %>
            </div>
          <% else %>
            <p class="text-zinc-500 text-sm">No deliveries yet.</p>
          <% end %>
        </div>

        <div class="w-full h-[2px] bg-zinc-200"></div>

        <%# Delete %>
        <div class="flex justify-end">
          <%= button_to "Delete Webhook", account_webhook_path(@webhook), method: :delete, data: { turbo_confirm: "Are you sure you want to delete this webhook?" }, class: "px-4 py-2 bg-white text-red-600 border-[2px] border-red-600 hover:bg-red-600 hover:text-white transition-colors font-bold text-xs uppercase" %>
        </div>
      </div>
    </div>

    <%# Footer %>
    <div class="h-2 border-t-[3px] border-zinc-900 bg-zinc-900 w-full"></div>
  </div>
</div>
