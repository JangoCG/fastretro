<% content_for :title, @user.name %>
<div class="px-4 py-4">
  <%= render BackButtonComponent.new(label: "Retros", href: retros_path, variant: :fizzy) %>
</div>

<div class="max-w-xl mx-auto px-4 py-8 font-sans">
  
  <%# Industrial Container %>
  <div class="bg-[#F8F5EC] border-[3px] border-zinc-900 shadow-[8px_8px_0px_0px_rgba(20,20,23,0.8)] relative">
    
    <%# Header Section %>
    <div class="p-6 border-b-[3px] border-zinc-900 bg-white relative">
       <%# Background Grid %>
      <div class="absolute inset-0 bg-[linear-gradient(to_right,#80808012_1px,transparent_1px),linear-gradient(to_bottom,#80808012_1px,transparent_1px)] bg-[size:10px_10px]"></div>
      
      <div class="relative z-10 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
        <h1 class="text-2xl font-black text-zinc-900 uppercase tracking-tighter">
          User Profile
        </h1>
        <% if Current.user == @user %>
          <%= link_to edit_user_path(@user), class: "group inline-flex w-full sm:w-auto items-center justify-center gap-2 px-4 py-2 bg-zinc-900 text-white border-[2px] border-zinc-900 font-bold uppercase tracking-widest text-xs hover:bg-zinc-700 transition-colors shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] hover:shadow-none" do %>
            <%= icon_tag "pencil", class: "w-4 h-4" %>
            <span>Edit profile</span>
          <% end %>
        <% end %>
      </div>
    </div>

    <%# Profile Body %>
    <div class="p-8 relative flex flex-col items-center gap-6">
       <%# Background Grid %>
       <div class="absolute inset-0 pointer-events-none bg-[linear-gradient(to_right,#8080800a_1px,transparent_1px),linear-gradient(to_bottom,#8080800a_1px,transparent_1px)] bg-[size:20px_20px]"></div>
       
       <div class="relative z-10 flex flex-col items-center gap-4">
         <%# Industrial Avatar %>
         <div class="w-24 h-24 border-[3px] border-zinc-900 bg-zinc-900 flex items-center justify-center text-white text-4xl font-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]">
            <%= @user.name.first.upcase %>
         </div>
         
         <div class="flex flex-col items-center text-center gap-1">
            <h2 class="text-xl font-black text-zinc-900 uppercase tracking-tight"><%= @user.name %></h2>
            
            <div class="text-xs font-mono font-bold uppercase tracking-wider">
              <% if !@user.active? %>
                <span class="text-red-600">Inactive Member</span>
              <% elsif !@user.verified? %>
                <span class="text-amber-600">Email Verification Pending</span>
                <p class="text-[0.7rem] text-zinc-500 mt-1 max-w-xs normal-case tracking-normal">
                  Check your inbox and confirm your email address.
                </p>
              <% else %>
                <%= mail_to @user.identity.email_address, class: "text-zinc-600 hover:text-zinc-900 transition-colors normal-case tracking-normal" %>
              <% end %>
            </div>

            <% if Current.user == @user %>
              <p class="text-xs text-zinc-500 font-mono uppercase tracking-wide mt-1">
                Want to update your details? Tap edit profile.
              </p>
            <% end %>
         </div>
       </div>

       <% if Current.user == @user %>
        <div class="w-full h-[2px] bg-zinc-200 my-2"></div>

        <div class="w-full space-y-6 relative z-10">
           <%= render "users/transfer", user: @user %>
        </div>

        <div class="w-full flex justify-center pt-6">
           <%= button_to session_url, method: :delete, class: "group relative inline-flex items-center justify-center px-6 py-2 bg-white text-zinc-900 border-[2px] border-zinc-900 font-bold uppercase tracking-widest text-xs hover:bg-red-600 hover:text-white hover:border-red-600 transition-colors", data: { turbo: false } do %>
             Sign Out
           <% end %>
        </div>
       <% end %>
    </div>

    <%# Technical Footer %>
    <div class="h-4 border-t-[3px] border-zinc-900 bg-zinc-900"></div>
  </div>
</div>

<% content_for :footer do %>
  <%= render "sessions/footer" %>
<% end %>
